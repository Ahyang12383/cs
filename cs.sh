#!/bin/bash
è®¾ç½® -æ¬§æ¬§ç®¡é“æ•…éšœ

# æ£€æŸ¥æ ¹æƒé™
å¦‚æžœ [ "$(id -u)" -ä¸œåŒ— 0 ]; ç„¶åŽ
å›žå£°-e â€œ033[31mâŒè¯·ä½¿ç”¨æ ¹ç”¨æˆ·è¿è¡Œ(é¡»è—¤ä¸€åˆ‡æ¢)033[0m "
    å‡ºå£ 1
èˆ¹æ–¹ä¸è´Ÿæ‹…è£…è´§è´¹ç”¨

# å®šä¹‰å®‰è£…è·¯å¾„å’Œç«¯å£
XUIæ–¹å‘="/etc/x-ui "
XUIæ¸¯="54321"  # é»˜è®¤é¢æ¿ç«¯å£ï¼Œå¯ä¿®æ”¹

# å®‰è£…ä¾èµ–
å›žå£°-e " 033[34mðŸ”§ æ­£åœ¨å®‰è£…ä¾èµ–åŒ…...033[0m "
å¦‚æžœ [ -f/etc/debian _ version]ï¼›ç„¶åŽ
aptæ›´æ–°è¡¨ç¤ºâ€œæœ‰â€¦çš„â€& aptå®‰è£…è¡¨ç¤ºâ€œæœ‰â€¦çš„â€curl wget unzip tar openssl
 å¦åˆ™å¦‚æžœ [ -f/etc/red hat-release]ï¼›ç„¶åŽ
yumæ›´æ–°è¡¨ç¤ºâ€œæœ‰â€¦çš„â€&& yumå®‰è£…è¡¨ç¤ºâ€œæœ‰â€¦çš„â€curl wget unzip tar openssl
å…¶ä»–
å›žå£°-e â€œ033[31mâŒä¸æ”¯æŒå½“å‰ç³»ç»Ÿ,ä»…æ”¯æŒUbuntu/Debian/CentOS 033[0m "
    å‡ºå£ 1
èˆ¹æ–¹ä¸è´Ÿæ‹…è£…è´§è´¹ç”¨

# ä¸‹è½½XUIæœ€æ–°ç‰ˆæœ¬ï¼ˆå®˜æ–¹æº)
å›žå£°-e " 033[34mðŸ“¥ æ­£åœ¨ä¸‹è½½XUIé¢æ¿...033[0m "
wget-qOxui . zip https://github . com/vaxilu/x-ui/releases/latest/download/x-ui-Linux-amd64 . zip

# è§£åŽ‹å®‰è£…
æ‹‰å¼€â€¦çš„æ‹‰é“¾é—®xui.zip-d $XUIæ–¹å‘
chmod +x$XUIæ–¹å‘/x-ui-linux-amd64

# åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰
cat >/etc/systemd/system/x-ui . service< < EOF
[å•ä½]
æè¿°=XUIé¢æ¿(åŸºäºŽxå…‰)
After=network.target

[æœåŠ¡]
ç±»åž‹=ç®€å•
å·¥ä½œç›®å½•=$XUIç›®å½•
ExecStart=$XUIç›®å½•/x-ui-linux-amd64
é‡å¯=å¼€-å¤±è´¥
RestartSec=5s

[å®‰è£…]
WantedBy =å¤šç”¨æˆ·.ç›®æ ‡
æ–‡ä»¶ç»“æŸ

# å¯åŠ¨æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯
systemctlå®ˆæŠ¤ç¨‹åº-é‡æ–°åŠ è½½
systemctlå¯ç”¨x-ui-çŽ°åœ¨

# æ£€æŸ¥è¿è¡ŒçŠ¶æ€
å¦‚æžœç³»ç»ŸæŽ§åˆ¶å¤„äºŽæ¿€æ´»çŠ¶æ€å®‰é™x-uiï¼›ç„¶åŽ
    # ç”Ÿæˆéšæœºç™»å½•å¯†ç 
    éšæœºé€šè¿‡=$(openssl rand -hex 8)
    $XUIæ–¹å‘/x-ui-linux-amd64 setting -ç”¨æˆ·åç®¡ç†-å¯†ç  $éšæœºé€šè¡Œè¯

å›žå£°-e " n 033[32mðŸŽ‰XUIé¢æ¿å®‰è£…æˆåŠŸï¼033[0m "
å›žå£°-e â€œ033[33ç±³ðŸ“‹ ç™»å½•ä¿¡æ¯:033[0ç±³]
å›žå£°-e "é¢æ¿åœ°å€:http://$(ç§‘å°”-icanhazip.com):$XUIæ¸¯"
å›žå£°-e "ç”¨æˆ·å:ç®¡ç†"
å›žå£°-e "  å¯†ç ï¼š$éšæœºé€šè¡Œè¯"
å›žå£°-e " n 033[34mðŸ’¡ å¸¸ç”¨å‘½ä»¤:033[0ç±³]
å›žå£°-e "å¯åŠ¨:systemctl start x-ui "
å›žå£°-e "åœæ­¢:systemctlåœæ­¢x-ui "
å›žå£°-e "é‡å¯:systemctlé‡æ–°å¯åŠ¨x-ui "
å›žå£°-e "æŸ¥çœ‹æ—¥å¿—:journalctl -u x-ui -f "
å…¶ä»–
å›žå£°-e "033[31mâŒè®¸å¯åŠ¨å¤±è´¥,è¯·æŸ¥çœ‹æ—¥å¿—:journalctl -u x-ui 033[0m "
    å‡ºå£ 1
èˆ¹æ–¹ä¸è´Ÿæ‹…è£…è´§è´¹ç”¨

# æ¸…ç†å®‰è£…æ–‡ä»¶
ç©ºé—´-å°„é¢‘xui.zip
å›žå£°-e â€œ033[32mâœ…åŒ—éƒ¨å®‰è£…å®Œæˆ,å¿«åŽ»ç™»å½•é¢æ¿é…ç½®èŠ‚ç‚¹å§ï¼033[0m "
